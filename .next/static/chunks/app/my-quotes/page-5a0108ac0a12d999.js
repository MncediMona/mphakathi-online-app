(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[569],{8182:function(t,e,a){Promise.resolve().then(a.bind(a,1806))},1870:function(t,e,a){"use strict";a.d(e,{B:function(){return l},b:function(){return s}});var r=a(7437),o=a(2265);let n=(0,o.createContext)({isStackReady:!1,stackError:null});function s(t){let{children:e}=t,[a,s]=(0,o.useState)(!1),[l,i]=(0,o.useState)(null);return(0,o.useEffect)(()=>{(async()=>{try{try{localStorage.setItem("__stack_test__","test"),localStorage.removeItem("__stack_test__")}catch(t){throw Error("localStorage not available")}"complete"!==document.readyState&&await new Promise(t=>{"complete"===document.readyState?t():window.addEventListener("load",()=>t(),{once:!0})}),await new Promise(t=>setTimeout(t,200)),s(!0)}catch(t){console.error("Stack Auth initialization failed:",t),i(t instanceof Error?t.message:"Unknown error")}})()},[]),(0,r.jsx)(n.Provider,{value:{isStackReady:a,stackError:l},children:e})}function l(){return(0,o.useContext)(n)}},1806:function(t,e,a){"use strict";a.r(e);var r=a(7437),o=a(2265),n=a(338);e.default=()=>{let{myQuotes:t,isLoading:e,error:a,userProfile:s,fetchMyQuotes:l}=(0,n.b)(),[i,c]=(0,o.useState)(null),[u,d]=(0,o.useState)(!1);(0,o.useEffect)(()=>{(null==s?void 0:s.role)!=="provider"||e||a||l()},[s,e,a,l]);let f=t=>{c(t),d(!0)};return e?(0,r.jsx)("div",{className:"text-center py-8",children:"Loading quotes..."}):a?(0,r.jsxs)("div",{className:"text-center py-8 text-red-600",children:["Error: ",a]}):s&&"provider"===s.role?(0,r.jsxs)("div",{className:"container mx-auto p-4",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-6 text-gray-800",children:"My Quotes"}),0===t.length?(0,r.jsx)("p",{className:"text-gray-600",children:"You haven't provided any quotes yet."}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(t=>(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200",children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold mb-2 text-gray-700",children:["Quote for Problem ID: ",t.problemId]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Amount: R",t.amount]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Status: ",(0,r.jsx)("span",{className:"font-medium ".concat("pending"===t.status?"text-yellow-600":"accepted"===t.status?"text-green-600":"text-red-600"),children:t.status})]}),(0,r.jsx)("button",{onClick:()=>f(t),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-200",children:"View Details"})]},t.id))})]}):(0,r.jsx)("div",{className:"text-center py-8 text-gray-600",children:"You don't have access to view quotes as a provider."})}},338:function(t,e,a){"use strict";a.d(e,{b:function(){return u},w:function(){return c}});var r=a(7437),o=a(2265),n=a(2394),s=a(1870);let l=(0,o.createContext)(void 0),i="http://localhost:8888";function c(t){let{children:e}=t,{isStackReady:a,stackError:c}=(0,s.B)(),{isAuthenticated:u,user:d,isLoading:f}=(0,n.a)(),h=(0,n.I)(),[m,g]=(0,o.useState)(null),[y,p]=(0,o.useState)([]),[v,w]=(0,o.useState)([]),[x,b]=(0,o.useState)(null),[k,S]=(0,o.useState)(!0),[j,E]=(0,o.useState)([]),[T,C]=(0,o.useState)([]),N=(0,o.useCallback)(()=>{(null==h?void 0:h.login)?h.login():console.warn("Stack Auth login not available.")},[h]),_=(0,o.useCallback)(()=>{(null==h?void 0:h.logout)?h.logout():console.warn("Stack Auth logout not available.")},[h]),P=(0,o.useCallback)(async()=>{try{let t=await fetch("".concat(i,"/.netlify/functions/get-branding"));if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let e=await t.json();g(e)}catch(t){console.error("Failed to fetch branding:",t)}},[]),I=(0,o.useCallback)(async()=>{try{let t=await fetch("".concat(i,"/.netlify/functions/get-pricing-plans"));if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let e=await t.json();p(e)}catch(t){console.error("Failed to fetch pricing plans:",t)}},[]),A=(0,o.useCallback)(async()=>{try{let t=await fetch("".concat(i,"/.netlify/functions/get-problems"));if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let e=await t.json();w(e)}catch(t){console.error("Failed to fetch public problems:",t)}},[]),q=(0,o.useCallback)(async()=>{if(!a||c||!u||!(null==d?void 0:d.id)){b(null);return}try{let t=await d.getIdToken(),e=await fetch("".concat(i,"/.netlify/functions/get-or-create-user-profile"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({auth_id:d.id,email:d.email,name:d.name||(d.email?d.email.split("@")[0]:"User")})});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let a=await e.json();b(a)}catch(t){console.error("Failed to fetch or create user profile:",t),b(null)}},[u,d,a,c]),F=(0,o.useCallback)(async()=>{if(!a||c||!u||!(null==x?void 0:x.id)){E([]);return}try{let t=await d.getIdToken(),e=await fetch("".concat(i,"/.netlify/functions/get-my-requests?userId=").concat(x.id),{headers:{Authorization:"Bearer ".concat(t)}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let a=await e.json();E(a)}catch(t){console.error("Failed to fetch my requests:",t),E([])}},[u,null==x?void 0:x.id,d,a,c]),H=(0,o.useCallback)(async()=>{if(!a||c||!u||!(null==x?void 0:x.id)||(null==x?void 0:x.role)!=="provider"){C([]);return}try{let t=await d.getIdToken(),e=await fetch("".concat(i,"/.netlify/functions/get-my-quotes?providerId=").concat(x.id),{headers:{Authorization:"Bearer ".concat(t)}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let a=await e.json();C(a)}catch(t){console.error("Failed to fetch my quotes:",t),C([])}},[u,null==x?void 0:x.id,null==x?void 0:x.role,d,a,c]);return(0,o.useEffect)(()=>{(async()=>{S(!0),await Promise.all([P(),I(),A()]),S(!1)})()},[P,I,A]),(0,o.useEffect)(()=>{u&&a&&!c?q():(b(null),E([]),C([]))},[u,q,a,c]),(0,o.useEffect)(()=>{(null==x?void 0:x.id)&&u&&a&&!c&&(F(),H())},[null==x?void 0:x.id,u,F,H,a,c]),(0,r.jsx)(l.Provider,{value:{branding:m,pricingPlans:y,publicProblems:v,userProfile:x,myRequests:j,myQuotes:T,fetchMyRequests:F,fetchPublicProblems:A,fetchMyQuotes:H,isAuthenticated:u,user:d,isLoading:f||k||!a,error:c,login:N,logout:_},children:e})}function u(){let t=(0,o.useContext)(l);if(void 0===t)throw Error("useAppContext must be used within an AppProvider");return t}}},function(t){t.O(0,[347,971,117,744],function(){return t(t.s=8182)}),_N_E=t.O()}]);