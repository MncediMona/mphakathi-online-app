(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{9373:function(e,t,a){Promise.resolve().then(a.bind(a,8485))},1870:function(e,t,a){"use strict";a.d(t,{B:function(){return i},b:function(){return s}});var o=a(7437),n=a(2265);let r=(0,n.createContext)({isStackReady:!1,stackError:null});function s(e){let{children:t}=e,[a,s]=(0,n.useState)(!1),[i,l]=(0,n.useState)(null);return(0,n.useEffect)(()=>{(async()=>{try{try{localStorage.setItem("__stack_test__","test"),localStorage.removeItem("__stack_test__")}catch(e){throw Error("localStorage not available")}"complete"!==document.readyState&&await new Promise(e=>{"complete"===document.readyState?e():window.addEventListener("load",()=>e(),{once:!0})}),await new Promise(e=>setTimeout(e,200)),s(!0)}catch(e){console.error("Stack Auth initialization failed:",e),l(e instanceof Error?e.message:"Unknown error")}})()},[]),(0,o.jsx)(r.Provider,{value:{isStackReady:a,stackError:i},children:t})}function i(){return(0,n.useContext)(r)}},8485:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var o=a(7437),n=a(2265),r=a(338);let s=e=>{let{message:t,onConfirm:a,onCancel:n,confirmText:r="Confirm",cancelText:s="Cancel"}=e;return(0,o.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,o.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-xl w-full max-w-sm rounded-md",children:[(0,o.jsx)("p",{className:"text-lg text-gray-800 mb-6",children:t}),(0,o.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,o.jsx)("button",{onClick:n,className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 transition-colors duration-200",children:s}),(0,o.jsx)("button",{onClick:a,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200",children:r})]})]})})};function i(){let{isAuthenticated:e,userProfile:t,user:a,isLoading:i}=n.useContext(r.AppContext),[l,c]=(0,n.useState)((null==t?void 0:t.email_notifications)||!1),[d,u]=(0,n.useState)((null==t?void 0:t.sms_notifications)||!1),[m,h]=(0,n.useState)(!1),[f,g]=(0,n.useState)(""),[x,y]=(0,n.useState)(()=>()=>{});n.useEffect(()=>{t&&(c(t.email_notifications||!1),u(t.sms_notifications||!1))},[t]);let b=async()=>{if(!e||!(null==t?void 0:t.id)){alert("You must be logged in to save preferences.");return}try{let e=await fetch("".concat("http://localhost:8888","/.netlify/functions/update-user-profile"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t.id,email_notifications:l,sms_notifications:d})});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));await e.json(),alert("Notification preferences saved successfully!")}catch(e){console.error("Failed to save notification preferences:",e),alert("Failed to save preferences: "+e.message)}};return i?(0,o.jsx)("div",{className:"flex items-center justify-center min-h-[calc(100vh-100px)]",children:(0,o.jsx)("div",{className:"text-xl font-semibold text-gray-700",children:"Loading settings..."})}):e?(0,o.jsxs)("section",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[(0,o.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Settings"}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,o.jsxs)("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200 rounded-md",children:[(0,o.jsx)("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Profile Information"}),(0,o.jsx)("p",{className:"text-gray-600",children:"Review your personal details."}),(0,o.jsxs)("div",{className:"mt-3",children:[(0,o.jsxs)("p",{className:"text-gray-700",children:["Name: ",(null==t?void 0:t.name)||(null==a?void 0:a.displayName)||(null==a?void 0:a.email)||"N/A"]}),(0,o.jsxs)("p",{className:"text-gray-700",children:["Email: ",(null==t?void 0:t.email)||(null==a?void 0:a.email)||"N/A"]}),(0,o.jsxs)("p",{className:"text-gray-700",children:["Role: ",(null==t?void 0:t.role)||"N/A"]})]}),(0,o.jsx)("button",{className:"mt-3 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors duration-200",children:"Edit Profile (Placeholder)"})]}),(0,o.jsxs)("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200 rounded-md",children:[(0,o.jsx)("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Notification Preferences"}),(0,o.jsx)("p",{className:"text-gray-600",children:"Configure how you receive alerts for new activity."}),(0,o.jsxs)("div",{className:"mt-3 flex items-center",children:[(0,o.jsx)("input",{type:"checkbox",id:"email-notifications",className:"mr-2",checked:l,onChange:e=>c(e.target.checked)}),(0,o.jsx)("label",{htmlFor:"email-notifications",className:"text-gray-700",children:"Email notifications"})]}),(0,o.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,o.jsx)("input",{type:"checkbox",id:"sms-notifications",className:"mr-2",checked:d,onChange:e=>u(e.target.checked)}),(0,o.jsx)("label",{htmlFor:"sms-notifications",className:"text-gray-700",children:"SMS notifications (coming soon)"})]}),(0,o.jsx)("button",{onClick:b,className:"mt-4 px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors duration-200",children:"Save Preferences"})]}),(0,o.jsxs)("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200 rounded-md",children:[(0,o.jsx)("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Data Management"}),(0,o.jsx)("p",{className:"text-gray-600",children:"Review and manage your data."}),(0,o.jsx)("button",{onClick:()=>{g("Are you sure you want to export your data? This action cannot be undone."),y(()=>()=>{console.log("Exporting data..."),alert("Data export initiated (placeholder). Check console for details."),h(!1)}),h(!0)},className:"mt-3 px-4 py-2 bg-yellow-500 text-white rounded-md hover:bg-yellow-600 transition-colors duration-200",children:"Export My Data"})]})]}),m&&(0,o.jsx)(s,{message:f,onConfirm:x,onCancel:()=>h(!1)})]}):(0,o.jsxs)("section",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[(0,o.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Access Denied"}),(0,o.jsx)("p",{className:"text-gray-700",children:"You must be logged in to view your settings."})]})}},338:function(e,t,a){"use strict";a.d(t,{b:function(){return d},w:function(){return c}});var o=a(7437),n=a(2265),r=a(2394),s=a(1870);let i=(0,n.createContext)(void 0),l="http://localhost:8888";function c(e){let{children:t}=e,{isStackReady:a,stackError:c}=(0,s.B)(),{isAuthenticated:d,user:u,isLoading:m}=(0,r.a)(),h=(0,r.I)(),[f,g]=(0,n.useState)(null),[x,y]=(0,n.useState)([]),[b,p]=(0,n.useState)([]),[v,w]=(0,n.useState)(null),[j,N]=(0,n.useState)(!0),[k,C]=(0,n.useState)([]),[S,E]=(0,n.useState)([]),T=(0,n.useCallback)(()=>{(null==h?void 0:h.login)?h.login():console.warn("Stack Auth login not available.")},[h]),_=(0,n.useCallback)(()=>{(null==h?void 0:h.logout)?h.logout():console.warn("Stack Auth logout not available.")},[h]),P=(0,n.useCallback)(async()=>{try{let e=await fetch("".concat(l,"/.netlify/functions/get-branding"));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json();g(t)}catch(e){console.error("Failed to fetch branding:",e)}},[]),A=(0,n.useCallback)(async()=>{try{let e=await fetch("".concat(l,"/.netlify/functions/get-pricing-plans"));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json();y(t)}catch(e){console.error("Failed to fetch pricing plans:",e)}},[]),F=(0,n.useCallback)(async()=>{try{let e=await fetch("".concat(l,"/.netlify/functions/get-problems"));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json();p(t)}catch(e){console.error("Failed to fetch public problems:",e)}},[]),I=(0,n.useCallback)(async()=>{if(!a||c||!d||!(null==u?void 0:u.id)){w(null);return}try{let e=await u.getIdToken(),t=await fetch("".concat(l,"/.netlify/functions/get-or-create-user-profile"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({auth_id:u.id,email:u.email,name:u.name||(u.email?u.email.split("@")[0]:"User")})});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let a=await t.json();w(a)}catch(e){console.error("Failed to fetch or create user profile:",e),w(null)}},[d,u,a,c]),H=(0,n.useCallback)(async()=>{if(!a||c||!d||!(null==v?void 0:v.id)){C([]);return}try{let e=await u.getIdToken(),t=await fetch("".concat(l,"/.netlify/functions/get-my-requests?userId=").concat(v.id),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let a=await t.json();C(a)}catch(e){console.error("Failed to fetch my requests:",e),C([])}},[d,null==v?void 0:v.id,u,a,c]),O=(0,n.useCallback)(async()=>{if(!a||c||!d||!(null==v?void 0:v.id)||(null==v?void 0:v.role)!=="provider"){E([]);return}try{let e=await u.getIdToken(),t=await fetch("".concat(l,"/.netlify/functions/get-my-quotes?providerId=").concat(v.id),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let a=await t.json();E(a)}catch(e){console.error("Failed to fetch my quotes:",e),E([])}},[d,null==v?void 0:v.id,null==v?void 0:v.role,u,a,c]);return(0,n.useEffect)(()=>{(async()=>{N(!0),await Promise.all([P(),A(),F()]),N(!1)})()},[P,A,F]),(0,n.useEffect)(()=>{d&&a&&!c?I():(w(null),C([]),E([]))},[d,I,a,c]),(0,n.useEffect)(()=>{(null==v?void 0:v.id)&&d&&a&&!c&&(H(),O())},[null==v?void 0:v.id,d,H,O,a,c]),(0,o.jsx)(i.Provider,{value:{branding:f,pricingPlans:x,publicProblems:b,userProfile:v,myRequests:k,myQuotes:S,fetchMyRequests:H,fetchPublicProblems:F,fetchMyQuotes:O,isAuthenticated:d,user:u,isLoading:m||j||!a,error:c,login:T,logout:_},children:t})}function d(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAppContext must be used within an AppProvider");return e}}},function(e){e.O(0,[347,971,117,744],function(){return e(e.s=9373)}),_N_E=e.O()}]);