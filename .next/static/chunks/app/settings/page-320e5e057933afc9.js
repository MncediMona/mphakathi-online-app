(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{9373:function(e,t,a){Promise.resolve().then(a.bind(a,1433))},9210:function(e,t,a){"use strict";a.d(t,{c:function(){return r}});var o=a(7437);a(2265);let r=e=>{let{message:t,onConfirm:a,onCancel:r,confirmText:n="Confirm",cancelText:s="Cancel"}=e;return(0,o.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,o.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-xl w-full max-w-sm rounded-md",children:[(0,o.jsx)("p",{className:"text-lg text-gray-800 mb-6",children:t}),(0,o.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,o.jsx)("button",{onClick:r,className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 transition-colors duration-200",children:s}),(0,o.jsx)("button",{onClick:a,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200",children:n})]})]})})}},1870:function(e,t,a){"use strict";a.d(t,{B:function(){return i},b:function(){return s}});var o=a(7437),r=a(2265);let n=(0,r.createContext)({isStackReady:!1,stackError:null});function s(e){let{children:t}=e,[a,s]=(0,r.useState)(!1),[i,l]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async()=>{try{try{localStorage.setItem("__stack_test__","test"),localStorage.removeItem("__stack_test__")}catch(e){throw Error("localStorage not available")}"complete"!==document.readyState&&await new Promise(e=>{"complete"===document.readyState?e():window.addEventListener("load",()=>e(),{once:!0})}),await new Promise(e=>setTimeout(e,200)),s(!0)}catch(e){console.error("Stack Auth initialization failed:",e),l(e instanceof Error?e.message:"Unknown error")}})()},[]),(0,o.jsx)(n.Provider,{value:{isStackReady:a,stackError:i},children:t})}function i(){return(0,r.useContext)(n)}},1433:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var o=a(7437),r=a(2265),n=a(338),s=a(9210);function i(){let{isAuthenticated:e,userProfile:t,user:a,isLoading:i}=r.useContext(n.I),[l,c]=(0,r.useState)((null==t?void 0:t.email_notifications)||!1),[d,u]=(0,r.useState)((null==t?void 0:t.sms_notifications)||!1),[h,f]=(0,r.useState)(!1),[m,g]=(0,r.useState)(""),[x,p]=(0,r.useState)(()=>()=>{});r.useEffect(()=>{t&&(c(t.email_notifications||!1),u(t.sms_notifications||!1))},[t]);let y=async()=>{if(!e||!(null==t?void 0:t.id)){alert("You must be logged in to save preferences.");return}try{let e=await fetch("".concat("http://localhost:8888","/.netlify/functions/update-user-profile"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t.id,email_notifications:l,sms_notifications:d})});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));await e.json(),alert("Notification preferences saved successfully!")}catch(e){console.error("Failed to save notification preferences:",e),alert("Failed to save preferences: "+e.message)}};return i?(0,o.jsx)("div",{className:"flex items-center justify-center min-h-[calc(100vh-100px)]",children:(0,o.jsx)("div",{className:"text-xl font-semibold text-gray-700",children:"Loading settings..."})}):e?(0,o.jsxs)("section",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[(0,o.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Settings"}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,o.jsxs)("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200 rounded-md",children:[(0,o.jsx)("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Profile Information"}),(0,o.jsx)("p",{className:"text-gray-600",children:"Review your personal details."}),(0,o.jsxs)("div",{className:"mt-3",children:[(0,o.jsxs)("p",{className:"text-gray-700",children:["Name: ",(null==t?void 0:t.name)||(null==a?void 0:a.displayName)||(null==a?void 0:a.email)||"N/A"]}),(0,o.jsxs)("p",{className:"text-gray-700",children:["Email: ",(null==t?void 0:t.email)||(null==a?void 0:a.email)||"N/A"]}),(0,o.jsxs)("p",{className:"text-gray-700",children:["Role: ",(null==t?void 0:t.role)||"N/A"]})]}),(0,o.jsx)("button",{className:"mt-3 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors duration-200",children:"Edit Profile (Placeholder)"})]}),(0,o.jsxs)("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200 rounded-md",children:[(0,o.jsx)("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Notification Preferences"}),(0,o.jsx)("p",{className:"text-gray-600",children:"Configure how you receive alerts for new activity."}),(0,o.jsxs)("div",{className:"mt-3 flex items-center",children:[(0,o.jsx)("input",{type:"checkbox",id:"email-notifications",className:"mr-2",checked:l,onChange:e=>c(e.target.checked)}),(0,o.jsx)("label",{htmlFor:"email-notifications",className:"text-gray-700",children:"Email notifications"})]}),(0,o.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,o.jsx)("input",{type:"checkbox",id:"sms-notifications",className:"mr-2",checked:d,onChange:e=>u(e.target.checked)}),(0,o.jsx)("label",{htmlFor:"sms-notifications",className:"text-gray-700",children:"SMS notifications (coming soon)"})]}),(0,o.jsx)("button",{onClick:y,className:"mt-4 px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors duration-200",children:"Save Preferences"})]}),(0,o.jsxs)("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200 rounded-md",children:[(0,o.jsx)("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Data Management"}),(0,o.jsx)("p",{className:"text-gray-600",children:"Review and manage your data."}),(0,o.jsx)("button",{onClick:()=>{g("Are you sure you want to export your data? This action cannot be undone."),p(()=>()=>{console.log("Exporting data..."),alert("Data export initiated (placeholder). Check console for details."),f(!1)}),f(!0)},className:"mt-3 px-4 py-2 bg-yellow-500 text-white rounded-md hover:bg-yellow-600 transition-colors duration-200",children:"Export My Data"})]})]}),h&&(0,o.jsx)(s.c,{message:m,onConfirm:x,onCancel:()=>f(!1)})]}):(0,o.jsxs)("section",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[(0,o.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Access Denied"}),(0,o.jsx)("p",{className:"text-gray-700",children:"You must be logged in to view your settings."})]})}},338:function(e,t,a){"use strict";a.d(t,{I:function(){return i},w:function(){return c}});var o=a(7437),r=a(2265),n=a(8104),s=a(1870);let i=(0,r.createContext)(null),l="http://localhost:8888",c=e=>{let{children:t}=e,{isStackReady:a,stackError:c}=(0,s.B)(),d=!1,u=null,h=!0,f=()=>console.warn("Stack Auth login not available (context not ready)."),m=()=>console.warn("Stack Auth logout not available (context not ready).");if(a&&!c)try{let{isAuthenticated:e,user:t,isLoading:a}=(0,n.a)(),o=(0,n.I)();d=e,u=t,h=a,f=o.login,m=o.logout}catch(e){console.warn("Error accessing Stack Auth context in AppProvider (might be a transient issue):",e)}let[g,x]=(0,r.useState)(null),[p,y]=(0,r.useState)([]),[b,v]=(0,r.useState)([]),[w,j]=(0,r.useState)(null),[N,k]=(0,r.useState)(!0),[S,C]=(0,r.useState)([]),[E,T]=(0,r.useState)([]),_=(0,r.useCallback)(async()=>{try{let e=await fetch("".concat(l,"/.netlify/functions/get-branding"));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json();x(t)}catch(e){console.error("Failed to fetch branding:",e)}},[]),I=(0,r.useCallback)(async()=>{try{let e=await fetch("".concat(l,"/.netlify/functions/get-pricing-plans"));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json();y(t)}catch(e){console.error("Failed to fetch pricing plans:",e)}},[]),P=(0,r.useCallback)(async()=>{try{let e=await fetch("".concat(l,"/.netlify/functions/get-problems"));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json();v(t)}catch(e){console.error("Failed to fetch public problems:",e)}},[]),A=(0,r.useCallback)(async()=>{if(!d||!(null==u?void 0:u.id)){j(null);return}try{let e=await u.getIdToken(),t=await fetch("".concat(l,"/.netlify/functions/get-or-create-user-profile"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({auth_id:u.id,email:u.email,name:u.name||(u.email?u.email.split("@")[0]:"User")})});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let a=await t.json();j(a)}catch(e){console.error("Failed to fetch or create user profile:",e),j(null)}},[d,u]),M=(0,r.useCallback)(async()=>{if(!d||!(null==w?void 0:w.id)){C([]);return}try{let e=await u.getIdToken(),t=await fetch("".concat(l,"/.netlify/functions/get-my-requests?userId=").concat(w.id),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let a=await t.json();C(a)}catch(e){console.error("Failed to fetch my requests:",e),C([])}},[d,null==w?void 0:w.id,u]),F=(0,r.useCallback)(async()=>{if(!d||!(null==w?void 0:w.id)||(null==w?void 0:w.role)!=="provider"){T([]);return}try{let e=await u.getIdToken(),t=await fetch("".concat(l,"/.netlify/functions/get-my-quotes?providerId=").concat(w.id),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let a=await t.json();T(a)}catch(e){console.error("Failed to fetch my quotes:",e),T([])}},[d,null==w?void 0:w.id,null==w?void 0:w.role,u]);(0,r.useEffect)(()=>{(async()=>{k(!0),await Promise.all([_(),I(),P()]),k(!1)})()},[_,I,P]),(0,r.useEffect)(()=>{d&&a?A():(j(null),C([]),T([]))},[d,A,a]),(0,r.useEffect)(()=>{(null==w?void 0:w.id)&&d&&a&&(M(),F())},[null==w?void 0:w.id,d,M,F,a]);let H={branding:g,pricingPlans:p,publicProblems:b,userProfile:w,myRequests:S,myQuotes:E,fetchMyRequests:M,fetchPublicProblems:P,fetchMyQuotes:F,isAuthenticated:d,user:u,isLoading:h||N||!a,login:f,logout:m};return(0,o.jsx)(i.Provider,{value:H,children:t})}},8104:function(e,t,a){"use strict";a.d(t,{I:function(){return l},a:function(){return i}});var o=a(2265),r="undefined"!=typeof globalThis?globalThis:void 0!==a.g?a.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{};"undefined"==typeof globalThis&&(r.globalThis=r);var n=Symbol.for("__stack-globals");r[n]??={},a(7437);var s=o.createContext(null);function i(e={}){let t=l(e);if(e.projectIdMustMatch&&t.projectId!==e.projectIdMustMatch)throw Error("Unexpected project ID in useStackApp: "+t.projectId);return e.projectIdMustMatch,t.useUser(e)}function l(e={}){let t=(0,o.useContext)(s);if(null===t)throw Error("useStackApp must be used within a StackProvider");let a=t.app;if(e.projectIdMustMatch&&a.projectId!==e.projectIdMustMatch)throw Error("Unexpected project ID in useStackApp: "+a.projectId);return a}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=9373)}),_N_E=e.O()}]);