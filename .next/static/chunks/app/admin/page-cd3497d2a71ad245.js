(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{4454:function(t,e,r){Promise.resolve().then(r.bind(r,2598))},2598:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return i}});var n=r(7437),o=r(2265),a=r(338);function i(){let{isAuthenticated:t,userProfile:e,isLoading:r}=o.useContext(a.I);return r?(0,n.jsx)("div",{className:"flex items-center justify-center min-h-[calc(100vh-100px)]",children:(0,n.jsx)("div",{className:"text-xl font-semibold text-gray-700",children:"Loading admin panel..."})}):t&&(null==e?void 0:e.role)==="admin"?(0,n.jsxs)("section",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Admin Panel"}),(0,n.jsx)("p",{className:"text-gray-700",children:"This section is for admin-specific tasks."}),(0,n.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-md",children:[(0,n.jsx)("p",{className:"font-semibold text-blue-800",children:"Admin actions will be implemented here."}),(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:"Manage Users"}),(0,n.jsx)("li",{children:"Approve Problems"}),(0,n.jsx)("li",{children:"Configure Pricing Plans"})]})]})]}):(0,n.jsxs)("section",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Access Denied"}),(0,n.jsx)("p",{className:"text-gray-700",children:"You must be logged in as an administrator to access this page."})]})}},1870:function(t,e,r){"use strict";r.d(e,{B:function(){return s},b:function(){return i}});var n=r(7437),o=r(2265);let a=(0,o.createContext)({isStackReady:!1,stackError:null});function i(t){let{children:e}=t,[r,i]=(0,o.useState)(!1),[s,c]=(0,o.useState)(null);return(0,o.useEffect)(()=>{(async()=>{try{try{localStorage.setItem("__stack_test__","test"),localStorage.removeItem("__stack_test__")}catch(t){throw Error("localStorage not available")}"complete"!==document.readyState&&await new Promise(t=>{"complete"===document.readyState?t():window.addEventListener("load",()=>t(),{once:!0})}),await new Promise(t=>setTimeout(t,200)),i(!0)}catch(t){console.error("Stack Auth initialization failed:",t),c(t instanceof Error?t.message:"Unknown error")}})()},[]),(0,n.jsx)(a.Provider,{value:{isStackReady:r,stackError:s},children:e})}function s(){return(0,o.useContext)(a)}},338:function(t,e,r){"use strict";r.d(e,{I:function(){return s},w:function(){return l}});var n=r(7437),o=r(2265),a=r(8104),i=r(1870);let s=(0,o.createContext)(null),c="http://localhost:8888",l=t=>{let{children:e}=t,{isStackReady:r,stackError:l}=(0,i.B)(),u=!1,d=null,f=!0,h=()=>console.warn("Stack Auth login not available (context not ready)."),m=()=>console.warn("Stack Auth logout not available (context not ready).");if(r&&!l)try{let{isAuthenticated:t,user:e,isLoading:r}=(0,a.a)(),n=(0,a.I)();u=t,d=e,f=r,h=n.login,m=n.logout}catch(t){console.warn("Error accessing Stack Auth context in AppProvider (might be a transient issue):",t)}let[p,g]=(0,o.useState)(null),[w,b]=(0,o.useState)([]),[y,x]=(0,o.useState)([]),[v,j]=(0,o.useState)(null),[k,S]=(0,o.useState)(!0),[T,I]=(0,o.useState)([]),[E,P]=(0,o.useState)([]),_=(0,o.useCallback)(async()=>{try{let t=await fetch("".concat(c,"/.netlify/functions/get-branding"));if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let e=await t.json();g(e)}catch(t){console.error("Failed to fetch branding:",t)}},[]),A=(0,o.useCallback)(async()=>{try{let t=await fetch("".concat(c,"/.netlify/functions/get-pricing-plans"));if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let e=await t.json();b(e)}catch(t){console.error("Failed to fetch pricing plans:",t)}},[]),C=(0,o.useCallback)(async()=>{try{let t=await fetch("".concat(c,"/.netlify/functions/get-problems"));if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let e=await t.json();x(e)}catch(t){console.error("Failed to fetch public problems:",t)}},[]),N=(0,o.useCallback)(async()=>{if(!u||!(null==d?void 0:d.id)){j(null);return}try{let t=await d.getIdToken(),e=await fetch("".concat(c,"/.netlify/functions/get-or-create-user-profile"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({auth_id:d.id,email:d.email,name:d.name||(d.email?d.email.split("@")[0]:"User")})});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let r=await e.json();j(r)}catch(t){console.error("Failed to fetch or create user profile:",t),j(null)}},[u,d]),M=(0,o.useCallback)(async()=>{if(!u||!(null==v?void 0:v.id)){I([]);return}try{let t=await d.getIdToken(),e=await fetch("".concat(c,"/.netlify/functions/get-my-requests?userId=").concat(v.id),{headers:{Authorization:"Bearer ".concat(t)}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let r=await e.json();I(r)}catch(t){console.error("Failed to fetch my requests:",t),I([])}},[u,null==v?void 0:v.id,d]),F=(0,o.useCallback)(async()=>{if(!u||!(null==v?void 0:v.id)||(null==v?void 0:v.role)!=="provider"){P([]);return}try{let t=await d.getIdToken(),e=await fetch("".concat(c,"/.netlify/functions/get-my-quotes?providerId=").concat(v.id),{headers:{Authorization:"Bearer ".concat(t)}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let r=await e.json();P(r)}catch(t){console.error("Failed to fetch my quotes:",t),P([])}},[u,null==v?void 0:v.id,null==v?void 0:v.role,d]);(0,o.useEffect)(()=>{(async()=>{S(!0),await Promise.all([_(),A(),C()]),S(!1)})()},[_,A,C]),(0,o.useEffect)(()=>{u&&r?N():(j(null),I([]),P([]))},[u,N,r]),(0,o.useEffect)(()=>{(null==v?void 0:v.id)&&u&&r&&(M(),F())},[null==v?void 0:v.id,u,M,F,r]);let H={branding:p,pricingPlans:w,publicProblems:y,userProfile:v,myRequests:T,myQuotes:E,fetchMyRequests:M,fetchPublicProblems:C,fetchMyQuotes:F,isAuthenticated:u,user:d,isLoading:f||k||!r,login:h,logout:m};return(0,n.jsx)(s.Provider,{value:H,children:e})}},8104:function(t,e,r){"use strict";r.d(e,{I:function(){return c},a:function(){return s}});var n=r(2265),o="undefined"!=typeof globalThis?globalThis:void 0!==r.g?r.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{};"undefined"==typeof globalThis&&(o.globalThis=o);var a=Symbol.for("__stack-globals");o[a]??={},r(7437);var i=n.createContext(null);function s(t={}){let e=c(t);if(t.projectIdMustMatch&&e.projectId!==t.projectIdMustMatch)throw Error("Unexpected project ID in useStackApp: "+e.projectId);return t.projectIdMustMatch,e.useUser(t)}function c(t={}){let e=(0,n.useContext)(i);if(null===e)throw Error("useStackApp must be used within a StackProvider");let r=e.app;if(t.projectIdMustMatch&&r.projectId!==t.projectIdMustMatch)throw Error("Unexpected project ID in useStackApp: "+r.projectId);return r}}},function(t){t.O(0,[971,117,744],function(){return t(t.s=4454)}),_N_E=t.O()}]);