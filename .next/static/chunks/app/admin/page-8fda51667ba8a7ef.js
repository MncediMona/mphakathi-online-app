(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{4454:function(e,t,a){Promise.resolve().then(a.bind(a,2598))},2598:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var n=a(7437),r=a(2265),o=a(338);function i(){let{isAuthenticated:e,userProfile:t,isLoading:a}=r.useContext(o.AppContext);return a?(0,n.jsx)("div",{className:"flex items-center justify-center min-h-[calc(100vh-100px)]",children:(0,n.jsx)("div",{className:"text-xl font-semibold text-gray-700",children:"Loading admin panel..."})}):e&&(null==t?void 0:t.role)==="admin"?(0,n.jsxs)("section",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Admin Panel"}),(0,n.jsx)("p",{className:"text-gray-700",children:"This section is for admin-specific tasks."}),(0,n.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-md",children:[(0,n.jsx)("p",{className:"font-semibold text-blue-800",children:"Admin actions will be implemented here."}),(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:"Manage Users"}),(0,n.jsx)("li",{children:"Approve Problems"}),(0,n.jsx)("li",{children:"Configure Pricing Plans"})]})]})]}):(0,n.jsxs)("section",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Access Denied"}),(0,n.jsx)("p",{className:"text-gray-700",children:"You must be logged in as an administrator to access this page."})]})}},1870:function(e,t,a){"use strict";a.d(t,{B:function(){return s},b:function(){return i}});var n=a(7437),r=a(2265);let o=(0,r.createContext)({isStackReady:!1,stackError:null});function i(e){let{children:t}=e,[a,i]=(0,r.useState)(!1),[s,l]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async()=>{try{try{localStorage.setItem("__stack_test__","test"),localStorage.removeItem("__stack_test__")}catch(e){throw Error("localStorage not available")}"complete"!==document.readyState&&await new Promise(e=>{"complete"===document.readyState?e():window.addEventListener("load",()=>e(),{once:!0})}),await new Promise(e=>setTimeout(e,200)),i(!0)}catch(e){console.error("Stack Auth initialization failed:",e),l(e instanceof Error?e.message:"Unknown error")}})()},[]),(0,n.jsx)(o.Provider,{value:{isStackReady:a,stackError:s},children:t})}function s(){return(0,r.useContext)(o)}},338:function(e,t,a){"use strict";a.d(t,{b:function(){return u},w:function(){return c}});var n=a(7437),r=a(2265),o=a(2394),i=a(1870);let s=(0,r.createContext)(void 0),l="http://localhost:8888";function c(e){let{children:t}=e,{isStackReady:a,stackError:c}=(0,i.B)(),{isAuthenticated:u,user:d,isLoading:f}=(0,o.a)(),h=(0,o.I)(),[m,g]=(0,r.useState)(null),[b,w]=(0,r.useState)([]),[p,y]=(0,r.useState)([]),[x,v]=(0,r.useState)(null),[k,j]=(0,r.useState)(!0),[S,C]=(0,r.useState)([]),[T,E]=(0,r.useState)([]),P=(0,r.useCallback)(()=>{(null==h?void 0:h.login)?h.login():console.warn("Stack Auth login not available.")},[h]),_=(0,r.useCallback)(()=>{(null==h?void 0:h.logout)?h.logout():console.warn("Stack Auth logout not available.")},[h]),N=(0,r.useCallback)(async()=>{try{let e=await fetch("".concat(l,"/.netlify/functions/get-branding"));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json();g(t)}catch(e){console.error("Failed to fetch branding:",e)}},[]),A=(0,r.useCallback)(async()=>{try{let e=await fetch("".concat(l,"/.netlify/functions/get-pricing-plans"));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json();w(t)}catch(e){console.error("Failed to fetch pricing plans:",e)}},[]),I=(0,r.useCallback)(async()=>{try{let e=await fetch("".concat(l,"/.netlify/functions/get-problems"));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json();y(t)}catch(e){console.error("Failed to fetch public problems:",e)}},[]),F=(0,r.useCallback)(async()=>{if(!a||c||!u||!(null==d?void 0:d.id)){v(null);return}try{let e=await d.getIdToken(),t=await fetch("".concat(l,"/.netlify/functions/get-or-create-user-profile"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({auth_id:d.id,email:d.email,name:d.name||(d.email?d.email.split("@")[0]:"User")})});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let a=await t.json();v(a)}catch(e){console.error("Failed to fetch or create user profile:",e),v(null)}},[u,d,a,c]),H=(0,r.useCallback)(async()=>{if(!a||c||!u||!(null==x?void 0:x.id)){C([]);return}try{let e=await d.getIdToken(),t=await fetch("".concat(l,"/.netlify/functions/get-my-requests?userId=").concat(x.id),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let a=await t.json();C(a)}catch(e){console.error("Failed to fetch my requests:",e),C([])}},[u,null==x?void 0:x.id,d,a,c]),B=(0,r.useCallback)(async()=>{if(!a||c||!u||!(null==x?void 0:x.id)||(null==x?void 0:x.role)!=="provider"){E([]);return}try{let e=await d.getIdToken(),t=await fetch("".concat(l,"/.netlify/functions/get-my-quotes?providerId=").concat(x.id),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));let a=await t.json();E(a)}catch(e){console.error("Failed to fetch my quotes:",e),E([])}},[u,null==x?void 0:x.id,null==x?void 0:x.role,d,a,c]);return(0,r.useEffect)(()=>{(async()=>{j(!0),await Promise.all([N(),A(),I()]),j(!1)})()},[N,A,I]),(0,r.useEffect)(()=>{u&&a&&!c?F():(v(null),C([]),E([]))},[u,F,a,c]),(0,r.useEffect)(()=>{(null==x?void 0:x.id)&&u&&a&&!c&&(H(),B())},[null==x?void 0:x.id,u,H,B,a,c]),(0,n.jsx)(s.Provider,{value:{branding:m,pricingPlans:b,publicProblems:p,userProfile:x,myRequests:S,myQuotes:T,fetchMyRequests:H,fetchPublicProblems:I,fetchMyQuotes:B,isAuthenticated:u,user:d,isLoading:f||k||!a,error:c,login:P,logout:_},children:t})}function u(){let e=(0,r.useContext)(s);if(void 0===e)throw Error("useAppContext must be used within an AppProvider");return e}}},function(e){e.O(0,[347,971,117,744],function(){return e(e.s=4454)}),_N_E=e.O()}]);