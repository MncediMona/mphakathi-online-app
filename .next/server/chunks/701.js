exports.id=701,exports.ids=[701],exports.modules={3287:(e,t,s)=>{Promise.resolve().then(s.bind(s,6014))},229:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},816:(e,t,s)=>{"use strict";s.d(t,{o:()=>h});var a=s(326),r=s(7577),l=s.n(r),o=s(4019),i=s(2881);let n=(0,i.Z)("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),d=(0,i.Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var c=s(1821),u=s(9064),m=s(819);let x="http://localhost:8888",h=({problemId:e,onClose:t,onShowQuoteModal:s})=>{let[i,h]=(0,r.useState)(null),[p,b]=(0,r.useState)([]),{isAuthenticated:g,user:f,userProfile:y,fetchMyRequests:j,fetchPublicProblems:v,fetchMyQuotes:N}=l().useContext(u.I),w=(0,r.useCallback)(async()=>{try{let t=await fetch(`${x}/.netlify/functions/get-problem-details?problemId=${e}`);if(!t.ok)throw Error(`HTTP error! status: ${t.status}`);let s=await t.json();h(s);let a=await fetch(`${x}/.netlify/functions/get-quotes-for-problem?problemId=${e}`);if(!a.ok)throw Error(`HTTP error! status: ${a.status}`);let r=await a.json();b(r)}catch(e){console.error("Failed to fetch problem details or quotes:",e),alert("Failed to load problem details: "+e.message)}},[e]);(0,r.useEffect)(()=>{w()},[w]);let k=(0,r.useCallback)(async e=>{if(!g||!f||!y||i?.user_id!==y.id){alert("You are not authorized to accept this quote.");return}try{let t=await fetch(`${x}/.netlify/functions/update-quote-status`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({quoteId:e,status:"accepted",problemId:i.id,userId:y.id})});if(!t.ok)throw Error(`HTTP error! status: ${t.status}`);await t.json(),alert("Quote accepted! Problem status updated."),w(),j&&j(),v&&v()}catch(e){console.error("Failed to accept quote:",e),alert("Failed to accept quote: "+e.message)}},[g,f,y,i,w,j,v]),S=(0,r.useCallback)(async(e,t)=>{if(!g||y?.role!=="provider"||!y?.id){alert("You must be logged in as an approved provider to submit a quote.");return}try{let s=await fetch(`${x}/.netlify/functions/submit-quote`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({problemId:e,providerId:y.id,amount:t.proposedBudget,details:t.motivation,proposedStartDate:t.proposedStartDate,proposedEndDate:t.proposedEndDate})});if(!s.ok)throw Error(`HTTP error! status: ${s.status}`);await s.json(),alert("Quote submitted successfully!"),w(),N&&N()}catch(e){console.error("Failed to submit quote:",e),alert("Failed to submit quote: "+e.message)}},[g,y,w,N]),[C,D]=(0,r.useState)(!1);if(!i)return a.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-xl w-full max-w-2xl rounded-md relative",children:[a.jsx("div",{className:"text-center",children:"Loading problem details..."}),a.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:a.jsx(o.Z,{size:24})})]})});let P=g&&y&&i.user_id===y.id,q=g&&y?.role==="provider";return(0,a.jsxs)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:[(0,a.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-xl w-full max-w-3xl rounded-md relative overflow-y-auto max-h-[90vh]",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:i.title}),a.jsx("p",{className:"text-gray-700 mb-6",children:i.description}),(0,a.jsxs)("p",{className:"text-gray-500 text-sm mb-4",children:["Location: ",i.location," | Status: ",i.status," | Budget: R",i.estimated_budget?.toFixed(2)||"N/A"]}),P&&"open"===i.status&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:[a.jsx("h3",{className:"text-xl font-semibold text-yellow-800 mb-2",children:"Quotes for Your Problem"}),p.length>0?a.jsx("div",{className:"space-y-4",children:p.map(e=>(0,a.jsxs)("div",{className:"p-4 bg-white border border-gray-200 rounded-md shadow-sm",children:[(0,a.jsxs)("p",{className:"font-semibold text-lg text-blue-700",children:["Amount: R",e.amount?.toFixed(2)]}),a.jsx("p",{className:"text-gray-700 text-sm mb-2",children:e.details})," ",(0,a.jsxs)("p",{className:"text-gray-600 text-xs",children:["By Provider ID: ",e.provider_id||"N/A"," | Status: ",e.status,e.proposedStartDate&&` | Start: ${new Date(e.proposedStartDate).toLocaleDateString()}`,e.proposedEndDate&&` | End: ${new Date(e.proposedEndDate).toLocaleDateString()}`]}),"pending"===e.status&&a.jsx("div",{className:"mt-3 flex space-x-2",children:(0,a.jsxs)("button",{onClick:()=>k(e.id),className:"px-3 py-1 bg-green-500 text-white text-sm rounded-md hover:bg-green-600 flex items-center",children:[a.jsx(n,{size:16,className:"mr-1"})," Accept"]})}),"accepted"===e.status&&(0,a.jsxs)("p",{className:"text-green-600 font-semibold mt-2 flex items-center",children:[a.jsx(d,{size:16,className:"mr-1"})," Accepted!"]})]},e.id))}):a.jsx("p",{className:"text-gray-600",children:"No quotes submitted yet for this problem."})]}),q&&"open"===i.status&&!p.some(e=>e.provider_id===y.id&&"pending"===e.status)&&(0,a.jsxs)("button",{onClick:()=>D(!0),className:"mt-6 px-6 py-3 bg-green-600 text-white font-semibold rounded-md hover:bg-green-700 transition-colors duration-200 flex items-center shadow-md",children:[a.jsx(c.Z,{size:20,className:"mr-2"})," Submit a Quote"]}),a.jsx("div",{className:"flex justify-end mt-8",children:a.jsx("button",{onClick:t,className:"px-6 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 transition-colors duration-200",children:"Close"})}),a.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:a.jsx(o.Z,{size:24})})]}),C&&a.jsx(m.G,{isOpen:C,onClose:()=>D(!1),problem:i,onSubmitQuote:S})]})}},819:(e,t,s)=>{"use strict";s.d(t,{G:()=>o});var a=s(326),r=s(7577),l=s(4019);let o=({isOpen:e,onClose:t,problem:s,onSubmitQuote:o})=>{let[i,n]=(0,r.useState)(""),[d,c]=(0,r.useState)(""),[u,m]=(0,r.useState)(""),[x,h]=(0,r.useState)(""),[p,b]=(0,r.useState)("");return e&&s?a.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-md max-h-screen overflow-y-auto rounded-md relative",children:[(0,a.jsxs)("h3",{className:"text-2xl font-bold text-gray-800 mb-6",children:['Submit Quote for: "',s.title,'"']}),a.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:a.jsx(l.Z,{size:24})}),(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),b(""),!i||!d||!u||!x){b("All fields are required.");return}if(0>=parseFloat(i)){b("Proposed Budget must be a positive number.");return}if(new Date(u)>new Date(x)){b("Proposed Start Date cannot be after Proposed End Date.");return}o(s.id,{proposedBudget:parseFloat(i),motivation:d,proposedStartDate:u,proposedEndDate:x})},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"proposedBudget",children:"Proposed Budget (R)"}),a.jsx("input",{type:"number",id:"proposedBudget",step:"0.01",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:i,onChange:e=>n(e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"motivation",children:"Motivation / Details"}),a.jsx("textarea",{id:"motivation",rows:"4",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:d,onChange:e=>c(e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"proposedStartDate",children:"Proposed Start Date"}),a.jsx("input",{type:"date",id:"proposedStartDate",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:u,onChange:e=>m(e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"proposedEndDate",children:"Proposed End Date"}),a.jsx("input",{type:"date",id:"proposedEndDate",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:x,onChange:e=>h(e.target.value),required:!0})]}),p&&a.jsx("p",{className:"text-red-500 text-sm",children:p}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 mt-6",children:[a.jsx("button",{type:"button",onClick:t,className:"px-6 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 transition-colors duration-200",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200",children:"Submit Quote"})]})]})]})}):null}},6014:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var a=s(326),r=s(7577),l=s.n(r),o=s(9064),i=s(999),n=s(8881);function d({children:e}){let t=(0,n.A)();return t?a.jsx(i.Z,{app:t,children:e}):a.jsx("div",{children:"Loading authentication..."})}var c=s(434),u=s(5047),m=s(5920),x=s(6283),h=s(1821),p=s(763),b=s(8378),g=s(1810),f=s(9635);function y(){let{isAuthenticated:e,userProfile:t,login:s,logout:r,isLoading:i}=l().useContext(o.I),n=(0,u.usePathname)();return i?(0,a.jsxs)("div",{className:"flex items-center justify-between p-4",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Mphakathi Online"}),a.jsx("div",{className:"text-gray-500",children:"Loading navigation..."})]}):(0,a.jsxs)("div",{className:"hidden md:flex items-center space-x-6",children:[(0,a.jsxs)(c.default,{href:"/",className:`text-gray-700 hover:text-blue-600 flex items-center ${"/"===n?"text-blue-600 font-semibold":""}`,children:[a.jsx(m.Z,{size:20,className:"mr-1"})," Dashboard"]}),e&&t?.role==="member"&&(0,a.jsxs)(c.default,{href:"/my-requests",className:`text-gray-700 hover:text-blue-600 flex items-center ${"/my-requests"===n?"text-blue-600 font-semibold":""}`,children:[a.jsx(x.Z,{size:20,className:"mr-1"})," My Requests"]}),e&&t?.role==="provider"&&(0,a.jsxs)(c.default,{href:"/my-quotes",className:`text-gray-700 hover:text-blue-600 flex items-center ${"/my-quotes"===n?"text-blue-600 font-semibold":""}`,children:[a.jsx(h.Z,{size:20,className:"mr-1"})," My Quotes"]}),e&&t?.role==="admin"&&(0,a.jsxs)(c.default,{href:"/admin",className:`text-gray-700 hover:text-blue-600 flex items-center ${"/admin"===n?"text-blue-600 font-semibold":""}`,children:[a.jsx(p.Z,{size:20,className:"mr-1"})," Admin"]}),e&&(0,a.jsxs)(c.default,{href:"/settings",className:`text-gray-700 hover:text-blue-600 flex items-center ${"/settings"===n?"text-blue-600 font-semibold":""}`,children:[a.jsx(b.Z,{size:20,className:"mr-1"})," Settings"]}),e?(0,a.jsxs)("button",{onClick:r,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 flex items-center",children:[a.jsx(g.Z,{size:20,className:"mr-1"})," Logout"]}):(0,a.jsxs)("button",{onClick:s,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center",children:[a.jsx(f.Z,{size:20,className:"mr-1"})," Login"]})]})}function j({children:e}){return(0,a.jsxs)("html",{lang:"en",children:[(0,a.jsxs)("head",{children:[a.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),a.jsx("title",{children:"Mphakathi Online"})]}),a.jsx("body",{children:a.jsx(d,{children:a.jsx(o.w,{children:(0,a.jsxs)("div",{className:"min-h-screen bg-gray-100 flex flex-col",children:[(0,a.jsxs)("nav",{className:"bg-white shadow-md p-4 flex justify-between items-center sticky top-0 z-40",children:[a.jsx("div",{className:"flex items-center",children:a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Mphakathi Online"})}),a.jsx(y,{})]}),a.jsx("main",{className:"flex-grow p-4 md:p-8",children:e})]})})})})]})}s(9752)},9064:(e,t,s)=>{"use strict";s.d(t,{I:()=>i,w:()=>n});var a=s(326),r=s(7577),l=s(2029),o=s(8881);let i=(0,r.createContext)(null),n=({children:e})=>{let t=(0,o.A)(),{isAuthenticated:s,user:n,isLoading:d}=(0,l.a)(),[c,u]=(0,r.useState)(null),[m,x]=(0,r.useState)([]),[h,p]=(0,r.useState)([]),[b,g]=(0,r.useState)(null),[f,y]=(0,r.useState)(!0),[j,v]=(0,r.useState)([]),[N,w]=(0,r.useState)([]),k=(0,r.useCallback)(async()=>{},[]),S=(0,r.useCallback)(async()=>{},[]),C=(0,r.useCallback)(async()=>{},[]),D=(0,r.useCallback)(async()=>{},[s,n]),P=(0,r.useCallback)(async()=>{},[s,b?.id]),q=(0,r.useCallback)(async()=>{},[s,b?.id,b?.role]);(0,r.useEffect)(()=>{(async()=>{y(!0),await Promise.all([k(),S(),C()]),y(!1)})()},[k,S,C]),(0,r.useEffect)(()=>{s?D():(g(null),v([]),w([]))},[s,D]),(0,r.useEffect)(()=>{b?.id&&s&&(P(),q())},[b?.id,s,P,q]);let z={branding:c,pricingPlans:m,publicProblems:h,userProfile:b,myRequests:j,myQuotes:N,fetchMyRequests:P,fetchPublicProblems:C,fetchMyQuotes:q,isAuthenticated:s,user:n,isLoading:d||f,login:t?.login||(()=>console.log("Login not available")),logout:t?.logout||(()=>console.log("Logout not available"))};return a.jsx(i.Provider,{value:z,children:e})}},8881:(e,t,s)=>{"use strict";function a(){return null}s.d(t,{A:()=>a})},4019:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(2881).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},7764:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(8570).createProxy)(String.raw`/home/runner/workspace/app/layout.js#default`)},9752:()=>{}};