(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2254:e=>{"use strict";e.exports=require("node:buffer")},6006:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d}),s(2232),s(7764),s(5866);var a=s(3191),r=s(8716),l=s(7922),o=s.n(l),i=s(5231),n={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>i[e]);s.d(t,n);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,2232)),"/home/runner/workspace/app/page.js"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,7764)),"/home/runner/workspace/app/layout.js"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/runner/workspace/app/page.js"],m="/page",x={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1819:(e,t,s)=>{Promise.resolve().then(s.bind(s,2811))},7207:(e,t,s)=>{"use strict";s.d(t,{c:()=>r});var a=s(326);s(7577);let r=({message:e,onConfirm:t,onCancel:s,confirmText:r="Confirm",cancelText:l="Cancel"})=>a.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-xl w-full max-w-sm rounded-md",children:[a.jsx("p",{className:"text-lg text-gray-800 mb-6",children:e}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[a.jsx("button",{onClick:s,className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 transition-colors duration-200",children:l}),a.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200",children:r})]})]})})},2811:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var a=s(326),r=s(7577),l=s.n(r),o=s(9064);let i=(0,s(2881).Z)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var n=s(4019);let d=({isOpen:e,onClose:t,onPost:s,isPaidMember:l})=>{let[o,i]=(0,r.useState)(""),[d,c]=(0,r.useState)(""),[m,x]=(0,r.useState)(""),[u,p]=(0,r.useState)(""),[h,g]=(0,r.useState)(""),[b,y]=(0,r.useState)("");return e?a.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-md max-h-screen overflow-y-auto rounded-md relative",children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Post a New Problem"}),a.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:a.jsx(n.Z,{size:24})}),!l&&(0,a.jsxs)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-4 rounded-md",role:"alert",children:[a.jsx("p",{className:"font-bold",children:"Free member limit:"}),a.jsx("p",{className:"text-sm",children:"As a free member, your problem will be public but features like accepting quotes are locked. Upgrade to a paid plan to unlock all features."})]}),(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),y(""),!o||!d||!m||!u||!h){y("All fields are required.");return}if(0>=parseFloat(h)){y("Budget must be a positive number.");return}s({title:o,description:d,category:m,location:u,estimated_budget:parseFloat(h),status:"open",is_approved:!1})},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"title",children:"Title"}),a.jsx("input",{type:"text",id:"title",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:o,onChange:e=>i(e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"description",children:"Description"}),a.jsx("textarea",{id:"description",rows:"3",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:d,onChange:e=>c(e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"category",children:"Category"}),a.jsx("input",{type:"text",id:"category",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:m,onChange:e=>x(e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"location",children:"Location"}),a.jsx("input",{type:"text",id:"location",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:u,onChange:e=>p(e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"estimatedBudget",children:"Estimated Budget (R)"}),a.jsx("input",{type:"number",id:"estimatedBudget",step:"0.01",className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:h,onChange:e=>g(e.target.value),required:!0})]}),b&&a.jsx("p",{className:"text-red-500 text-sm",children:b}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4 mt-6",children:[a.jsx("button",{type:"button",onClick:t,className:"px-6 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 transition-colors duration-200",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-6 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200",children:"Post Problem"})]})]})]})}):null};var c=s(819),m=s(816),x=s(7207);let u="http://localhost:8888";function p(){let{isAuthenticated:e,user:t,userProfile:s,publicProblems:n,pricingPlans:p,myRequests:h,myQuotes:g,fetchMyRequests:b,fetchPublicProblems:y,fetchMyQuotes:j,isLoading:f}=l().useContext(o.I),[N,v]=(0,r.useState)(!1),[w,P]=(0,r.useState)(!1),[k,C]=(0,r.useState)(null),[S,_]=(0,r.useState)(!1),[q,F]=(0,r.useState)(null),[M,D]=(0,r.useState)(!1),[O,T]=(0,r.useState)(""),[A,E]=(0,r.useState)(()=>()=>{}),Q=l().useCallback(async t=>{if(!e||!s?.id){alert("You must be logged in to post a problem.");return}try{let e=await fetch(`${u}/.netlify/functions/post-problem`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,userId:s.id})});if(!e.ok)throw Error(`HTTP error! status: ${e.status}`);(await e.json()).is_approved&&y(),b(),v(!1),alert("Problem posted successfully! Awaiting admin approval if applicable.")}catch(e){console.error("Failed to post problem:",e),alert("Failed to post problem: "+e.message)}},[e,s,y,b]),B=l().useCallback(async(t,a)=>{if(!e||s?.role!=="provider"||!s?.id){alert("You must be logged in as an approved provider to submit a quote.");return}try{let e=await fetch(`${u}/.netlify/functions/submit-quote`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({problemId:t,providerId:s.id,amount:a.proposedBudget,details:a.motivation,proposedStartDate:a.proposedStartDate,proposedEndDate:a.proposedEndDate})});if(!e.ok)throw Error(`HTTP error! status: ${e.status}`);await e.json(),C(null),P(!1),j(),alert("Quote submitted successfully!")}catch(e){console.error("Failed to submit quote:",e),alert("Failed to submit quote: "+e.message)}},[e,s,j]);return(0,a.jsxs)(a.Fragment,{children:[a.jsx(()=>f?a.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-100px)]",children:a.jsx("div",{className:"text-xl font-semibold text-gray-700",children:"Loading dashboard data..."})}):e?s?.role==="member"?(0,a.jsxs)("section",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[a.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Member Dashboard"}),(0,a.jsxs)("p",{className:"text-gray-700 mb-4",children:["Hello, ",s?.name||s?.email||t?.email||"User","! Your role is Member."]}),(0,a.jsxs)("button",{onClick:()=>v(!0),className:"mb-6 px-6 py-3 bg-blue-600 text-white font-semibold rounded-md hover:bg-blue-700 transition-colors duration-200 flex items-center shadow-md",children:[a.jsx(i,{size:20,className:"mr-2"})," Post a New Problem"]}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-semibold text-gray-700 mb-4",children:["My Posted Problems (",h.length,")"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:h.length>0?h.map(e=>(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200 shadow-sm",children:[a.jsx("h4",{className:"text-lg font-medium text-gray-800 mb-1",children:e.title}),a.jsx("p",{className:"text-gray-600 text-sm mb-2",children:e.description}),(0,a.jsxs)("p",{className:"text-gray-500 text-xs",children:["Status: ",e.status]}),a.jsx("button",{onClick:()=>{F(e.id),_(!0)},className:"mt-2 px-3 py-1 bg-blue-500 text-white text-sm rounded-md hover:bg-blue-600",children:"View Details"})]},e.id)):a.jsx("p",{className:"text-gray-600",children:"You haven't posted any problems yet."})})]})]}):s?.role==="provider"?(0,a.jsxs)("section",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[a.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Provider Dashboard"}),(0,a.jsxs)("p",{className:"text-gray-700 mb-4",children:["Hello, ",s?.name||s?.email||t?.email||"User","! Your role is Provider."]}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-semibold text-gray-700 mb-4",children:["Available Problems to Quote On (",n.length,")"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.length>0?n.filter(e=>"open"===e.status).map(e=>(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200 shadow-md",children:[a.jsx("h4",{className:"text-lg font-medium text-gray-800 mb-1",children:e.title}),a.jsx("p",{className:"text-gray-600 text-sm mb-2",children:e.description}),(0,a.jsxs)("p",{className:"text-gray-500 text-xs",children:["Location: ",e.location," | Budget: R",e.estimated_budget?.toFixed(2)]}),a.jsx("button",{onClick:()=>{F(e.id),_(!0)},className:"mt-2 px-3 py-1 bg-blue-500 text-white text-sm rounded-md hover:bg-blue-600",children:"View Details"}),g.some(t=>t.problem_id===e.id&&t.provider_id===s.id)?a.jsx("span",{className:"text-sm text-gray-500 ml-2",children:" (Quoted)"}):a.jsx("button",{onClick:()=>{C(e),P(!0)},className:"mt-2 ml-2 px-3 py-1 bg-green-500 text-white text-sm rounded-md hover:bg-green-600",children:"Submit Quote"})]},e.id)):a.jsx("p",{className:"text-gray-600",children:"No open problems available to quote on."})})]}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-semibold text-gray-700 mb-4",children:["My Submitted Quotes (",g.length,")"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:g.length>0?g.map(e=>(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200 shadow-sm",children:[(0,a.jsxs)("h4",{className:"text-lg font-medium text-gray-800 mb-1",children:["Quote for: ",e.problem_title]}),(0,a.jsxs)("p",{className:"text-gray-600 text-sm mb-2",children:["Amount: R",e.amount?.toFixed(2)]}),(0,a.jsxs)("p",{className:"text-gray-500 text-xs",children:["Status: ",e.status]})]},e.id)):a.jsx("p",{className:"text-gray-600",children:"You haven't submitted any quotes yet."})})]})]}):null:(0,a.jsxs)("section",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[a.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Welcome to Mphakathi Online!"}),a.jsx("p",{className:"text-gray-700",children:"Please log in to access all features."}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:["Public Problems (",n.length,")"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.length>0?n.map(e=>(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200 shadow-sm",children:[a.jsx("h4",{className:"text-lg font-medium text-gray-800 mb-1",children:e.title}),a.jsx("p",{className:"text-gray-600 text-sm mb-2",children:e.description}),(0,a.jsxs)("p",{className:"text-gray-500 text-xs",children:["Location: ",e.location]})]},e.id)):a.jsx("p",{className:"text-gray-600",children:"No public problems available. Check back soon!"})}),(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsxs)("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:["Our Pricing Plans (",p.length,")"]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.length>0?p.map(e=>(0,a.jsxs)("div",{className:"p-6 bg-gray-50 rounded-lg border border-gray-200 shadow-md flex flex-col justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"text-xl font-bold text-blue-700 mb-2",children:e.name}),a.jsx("p",{className:"text-gray-700 text-sm mb-3",children:e.description}),a.jsx("p",{className:"text-2xl font-extrabold text-gray-900 mb-4",children:e.price_display}),a.jsx("ul",{className:"mt-2 text-gray-600 text-sm list-disc list-inside space-y-1",children:e.features?.map((e,t)=>a.jsx("li",{children:e},t))})]}),a.jsx("button",{className:"mt-6 w-full py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200 shadow-sm",children:"Contact Us"===e.price_display?"Contact Sales":"Choose Plan"})]},e.id)):a.jsx("p",{className:"text-gray-600",children:"No pricing plans available at the moment."})})]})]})]}),{}),a.jsx(d,{isOpen:N,onClose:()=>v(!1),onPost:Q,isPaidMember:s?.is_paid_member}),a.jsx(c.G,{isOpen:w,onClose:()=>P(!1),problem:k,onSubmitQuote:B}),S&&a.jsx(m.o,{problemId:q,onClose:()=>_(!1),onShowQuoteModal:e=>{C(e),P(!0)}}),M&&a.jsx(x.c,{message:O,onConfirm:A,onCancel:()=>D(!1)})]})}},2232:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(8570).createProxy)(String.raw`/home/runner/workspace/app/page.js#default`)}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[985,701],()=>s(6006));module.exports=a})();